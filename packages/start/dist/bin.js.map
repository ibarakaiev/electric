{"version":3,"sources":["../src/cli.ts","../src/bin.ts"],"sourcesContent":["#!/usr/bin/env node\n\nimport { execSync } from 'child_process'\nimport { provisionElectricResources } from './electric-api.js'\nimport { setupTemplate } from './template-setup.js'\nimport { join } from 'path'\n\nfunction printNextSteps(appName: string, fullSetup: boolean = false) {\n  console.log(`Next steps:`)\n  if (appName !== `.`) {\n    console.log(`  cd ${appName}`)\n  }\n\n  if (fullSetup) {\n    console.log(`  pnpm install`)\n    console.log(`  pnpm migrate`)\n  }\n\n  console.log(`  pnpm dev`)\n  console.log(``)\n  console.log(`Commands:`)\n  console.log(`  pnpm psql             # Connect to database`)\n  console.log(`  pnpm claim            # Claim cloud resources`)\n  console.log(`  pnpm deploy:netlify   # Deploy to Netlify`)\n  console.log(``)\n  console.log(`Tutorial: https://electric-sql.com/docs`)\n}\n\nasync function main() {\n  const args = process.argv.slice(2)\n\n  if (args.length === 0) {\n    console.error(`Usage: npx @electric-sql/start <app-name>`)\n    console.error(\n      `       npx @electric-sql/start .  (configure current directory)`\n    )\n\n    process.exit(1)\n  }\n\n  const appName = args[0]\n\n  // Validate app name (skip validation for \".\" which means current directory)\n  if (appName !== `.` && !/^[a-zA-Z0-9-_]+$/.test(appName)) {\n    console.error(\n      `App name must contain only letters, numbers, hyphens, and underscores`\n    )\n\n    process.exit(1)\n  }\n\n  if (appName === `.`) {\n    console.log(`Configuring current directory...`)\n  } else {\n    console.log(`Creating app: ${appName}`)\n  }\n\n  try {\n    const credentials = await provisionElectricResources()\n\n    // Step 2: Setup TanStack Start template\n    console.log(`Setting up template...`)\n    await setupTemplate(appName, credentials)\n\n    console.log(`Installing dependencies...`)\n    try {\n      execSync(`pnpm install`, {\n        stdio: `inherit`,\n        cwd: appName === `.` ? process.cwd() : join(process.cwd(), appName),\n      })\n    } catch (_error) {\n      console.log(`Failed to install dependencies`)\n      printNextSteps(appName, true)\n      process.exit(1)\n    }\n\n    console.log(`Running migrations...`)\n    try {\n      execSync(`pnpm migrate`, {\n        stdio: `inherit`,\n        cwd: appName === `.` ? process.cwd() : join(process.cwd(), appName),\n      })\n    } catch (_error) {\n      console.log(`Failed to apply migrations`)\n      printNextSteps(appName, true)\n      process.exit(1)\n    }\n\n    // Step 3: Display completion message\n    console.log(`Setup complete`)\n    printNextSteps(appName)\n  } catch (error) {\n    console.error(\n      `Setup failed:`,\n      error instanceof Error ? error.message : error\n    )\n    process.exit(1)\n  }\n}\n\nexport { main }\n","import { main } from './cli.js'\n\nmain().catch((error) => {\n  console.error(`Unexpected error:`, error)\n  process.exit(1)\n})\n"],"mappings":";;;;;;;AAEA,SAAS,gBAAgB;AAGzB,SAAS,YAAY;AAErB,SAAS,eAAe,SAAiB,YAAqB,OAAO;AACnE,UAAQ,IAAI,aAAa;AACzB,MAAI,YAAY,KAAK;AACnB,YAAQ,IAAI,QAAQ,OAAO,EAAE;AAAA,EAC/B;AAEA,MAAI,WAAW;AACb,YAAQ,IAAI,gBAAgB;AAC5B,YAAQ,IAAI,gBAAgB;AAAA,EAC9B;AAEA,UAAQ,IAAI,YAAY;AACxB,UAAQ,IAAI,EAAE;AACd,UAAQ,IAAI,WAAW;AACvB,UAAQ,IAAI,+CAA+C;AAC3D,UAAQ,IAAI,iDAAiD;AAC7D,UAAQ,IAAI,6CAA6C;AACzD,UAAQ,IAAI,EAAE;AACd,UAAQ,IAAI,yCAAyC;AACvD;AAEA,eAAe,OAAO;AACpB,QAAM,OAAO,QAAQ,KAAK,MAAM,CAAC;AAEjC,MAAI,KAAK,WAAW,GAAG;AACrB,YAAQ,MAAM,2CAA2C;AACzD,YAAQ;AAAA,MACN;AAAA,IACF;AAEA,YAAQ,KAAK,CAAC;AAAA,EAChB;AAEA,QAAM,UAAU,KAAK,CAAC;AAGtB,MAAI,YAAY,OAAO,CAAC,mBAAmB,KAAK,OAAO,GAAG;AACxD,YAAQ;AAAA,MACN;AAAA,IACF;AAEA,YAAQ,KAAK,CAAC;AAAA,EAChB;AAEA,MAAI,YAAY,KAAK;AACnB,YAAQ,IAAI,kCAAkC;AAAA,EAChD,OAAO;AACL,YAAQ,IAAI,iBAAiB,OAAO,EAAE;AAAA,EACxC;AAEA,MAAI;AACF,UAAM,cAAc,MAAM,2BAA2B;AAGrD,YAAQ,IAAI,wBAAwB;AACpC,UAAM,cAAc,SAAS,WAAW;AAExC,YAAQ,IAAI,4BAA4B;AACxC,QAAI;AACF,eAAS,gBAAgB;AAAA,QACvB,OAAO;AAAA,QACP,KAAK,YAAY,MAAM,QAAQ,IAAI,IAAI,KAAK,QAAQ,IAAI,GAAG,OAAO;AAAA,MACpE,CAAC;AAAA,IACH,SAAS,QAAQ;AACf,cAAQ,IAAI,gCAAgC;AAC5C,qBAAe,SAAS,IAAI;AAC5B,cAAQ,KAAK,CAAC;AAAA,IAChB;AAEA,YAAQ,IAAI,uBAAuB;AACnC,QAAI;AACF,eAAS,gBAAgB;AAAA,QACvB,OAAO;AAAA,QACP,KAAK,YAAY,MAAM,QAAQ,IAAI,IAAI,KAAK,QAAQ,IAAI,GAAG,OAAO;AAAA,MACpE,CAAC;AAAA,IACH,SAAS,QAAQ;AACf,cAAQ,IAAI,4BAA4B;AACxC,qBAAe,SAAS,IAAI;AAC5B,cAAQ,KAAK,CAAC;AAAA,IAChB;AAGA,YAAQ,IAAI,gBAAgB;AAC5B,mBAAe,OAAO;AAAA,EACxB,SAAS,OAAO;AACd,YAAQ;AAAA,MACN;AAAA,MACA,iBAAiB,QAAQ,MAAM,UAAU;AAAA,IAC3C;AACA,YAAQ,KAAK,CAAC;AAAA,EAChB;AACF;;;AChGA,KAAK,EAAE,MAAM,CAAC,UAAU;AACtB,UAAQ,MAAM,qBAAqB,KAAK;AACxC,UAAQ,KAAK,CAAC;AAChB,CAAC;","names":[]}